# 영화 평점 분석 실습


```python
import pandas as pd
from pandas import Series, DataFrame
import numpy as np
```

## 1. 영화 평점 데이터 적재 및 전처리


```python
# 사용자 데이터 읽어오기
users = pd.read_csv('data/movielens/users.dat', sep = '::', engine = 'python',
                   names = ['사용자아이디', '성별','연령','직업','지역'])
users.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>M</td>
      <td>25</td>
      <td>15</td>
      <td>55117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>M</td>
      <td>45</td>
      <td>7</td>
      <td>02460</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>M</td>
      <td>25</td>
      <td>20</td>
      <td>55455</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 평점 데이터 읽어오기
ratings = pd.read_csv('data/movielens/ratings.dat', sep = '::', engine = 'python',
                   names = ['사용자아이디', '영화아이디','평점','타임스탬프'])
ratings.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 영화데이터 읽어오기
movies = pd.read_csv('data/movielens/movies.dat', sep = '::', engine = 'python',
                   names = ['영화아이디','영화제목','장르'], encoding = 'latin-1')
movies.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>영화아이디</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 3개의 데이터프레임을 하나로 합치기
data = pd.merge(users, ratings)
data = pd.merge(data, movies)
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
  </tbody>
</table>
</div>




```python
print('사용자 수:', len(users))
print('리뷰 수:', len(ratings)) #ratings.사용자아이디.count()
print('영화 수:', len(movies))
```

    사용자 수: 6040
    리뷰 수: 1000209
    영화 수: 3883
    


```python
# 모든 사용자가 리뷰를 했나?
ratings.사용자아이디.nunique() #모든 사용자가 영화 리뷰에 참여!
```




    6040




```python
# 리뷰가 없는 영화는 있는가?
ratings.nunique() #영화 수는 3883, 영화 아이디는 3706으로, 176개는 영화 리뷰가 없음!
```




    사용자아이디      6040
    영화아이디       3706
    평점             5
    타임스탬프     458455
    dtype: int64



## 2. 보고 싶은 영화 찾기
영화들의 평점 평균을 구하여, 사람들에게 인정받는 (평점이 높은) 영화 찾기


```python
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 영화들의 평점 평균을 구하여, 평점이 높은 영화 찾기 
data.pivot_table(index='영화제목', aggfunc='mean', values='평점')\
                 .sort_values(by='평점', ascending=False).head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ulysses (Ulisse) (1954)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Lured (1947)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Follow the Bitch (1998)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Bittersweet Motel (2000)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Song of Freedom (1936)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>One Little Indian (1973)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Smashing Time (1967)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Schlafes Bruder (Brother of Sleep) (1995)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Gate of Heavenly Peace, The (1995)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Baby, The (1973)</th>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.pivot_table(index='영화제목', aggfunc='mean', values='평점').nlargest(10, '평점') #nsmallest
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Baby, The (1973)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Bittersweet Motel (2000)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Follow the Bitch (1998)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Gate of Heavenly Peace, The (1995)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Lured (1947)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>One Little Indian (1973)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Schlafes Bruder (Brother of Sleep) (1995)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Smashing Time (1967)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Song of Freedom (1936)</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Ulysses (Ulisse) (1954)</th>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>



평균 평점이 만점인 영화들이 최상위에 위치함. 
일반적으로 평점이 만점인 경우는 대부분 평점의 개수가 매우 적은 경우이므로, 이를 확인하기 위해 평점의 개수도 함께 구해본다. 


```python
#영화제목도 중복될 수 있으므로, 제대로 하려면 영화아이디로 해야 됨
# 중복된 영화제목이 있는지 확인

movies.영화제목.nunique() #위에서 구한 영화 수와 일치하므로 중복X
```




    3883




```python
movies.nunique()
```




    영화아이디    3883
    영화제목     3883
    장르        301
    dtype: int64




```python
#data.pivot_table(index=['영화아이디','영화제목'], aggfunc='mean', values='평점')\ 
#                 .nlargest(10, '평점') #nsmallest
```


```python
data.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th></th>
      <th>평점</th>
      <th>평점</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$1,000,000 Duck (1971)</th>
      <td>3.027027</td>
      <td>37</td>
    </tr>
    <tr>
      <th>'Night Mother (1986)</th>
      <td>3.371429</td>
      <td>70</td>
    </tr>
    <tr>
      <th>'Til There Was You (1997)</th>
      <td>2.692308</td>
      <td>52</td>
    </tr>
    <tr>
      <th>'burbs, The (1989)</th>
      <td>2.910891</td>
      <td>303</td>
    </tr>
    <tr>
      <th>...And Justice for All (1979)</th>
      <td>3.713568</td>
      <td>199</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zed &amp; Two Noughts, A (1985)</th>
      <td>3.413793</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Zero Effect (1998)</th>
      <td>3.750831</td>
      <td>301</td>
    </tr>
    <tr>
      <th>Zero Kelvin (Kjærlighetens kjøtere) (1995)</th>
      <td>3.500000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Zeus and Roxanne (1997)</th>
      <td>2.521739</td>
      <td>23</td>
    </tr>
    <tr>
      <th>eXistenZ (1999)</th>
      <td>3.256098</td>
      <td>410</td>
    </tr>
  </tbody>
</table>
<p>3706 rows × 2 columns</p>
</div>




```python
data.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')\
.nlargest(10, ('mean','평점')) #평점 높고, 개수도 많은 걸 찾자!
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th></th>
      <th>평점</th>
      <th>평점</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Baby, The (1973)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Bittersweet Motel (2000)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Follow the Bitch (1998)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Gate of Heavenly Peace, The (1995)</th>
      <td>5.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Lured (1947)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>One Little Indian (1973)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Schlafes Bruder (Brother of Sleep) (1995)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Smashing Time (1967)</th>
      <td>5.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Song of Freedom (1936)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Ulysses (Ulisse) (1954)</th>
      <td>5.0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
#평점 평균이 4.5 이상이고, 평점의 개수가 1000개 이상인 영화를 보고싶은 영화로 지정!
영화평점 = data.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')
영화평점.columns=['평점평균','평점개수']
```


```python
영화평점
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균</th>
      <th>평점개수</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$1,000,000 Duck (1971)</th>
      <td>3.027027</td>
      <td>37</td>
    </tr>
    <tr>
      <th>'Night Mother (1986)</th>
      <td>3.371429</td>
      <td>70</td>
    </tr>
    <tr>
      <th>'Til There Was You (1997)</th>
      <td>2.692308</td>
      <td>52</td>
    </tr>
    <tr>
      <th>'burbs, The (1989)</th>
      <td>2.910891</td>
      <td>303</td>
    </tr>
    <tr>
      <th>...And Justice for All (1979)</th>
      <td>3.713568</td>
      <td>199</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zed &amp; Two Noughts, A (1985)</th>
      <td>3.413793</td>
      <td>29</td>
    </tr>
    <tr>
      <th>Zero Effect (1998)</th>
      <td>3.750831</td>
      <td>301</td>
    </tr>
    <tr>
      <th>Zero Kelvin (Kjærlighetens kjøtere) (1995)</th>
      <td>3.500000</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Zeus and Roxanne (1997)</th>
      <td>2.521739</td>
      <td>23</td>
    </tr>
    <tr>
      <th>eXistenZ (1999)</th>
      <td>3.256098</td>
      <td>410</td>
    </tr>
  </tbody>
</table>
<p>3706 rows × 2 columns</p>
</div>




```python
영화평점[(영화평점.평점평균 >= 4.5) & (영화평점.평점개수 >=1000)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균</th>
      <th>평점개수</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Godfather, The (1972)</th>
      <td>4.524966</td>
      <td>2223</td>
    </tr>
    <tr>
      <th>Schindler's List (1993)</th>
      <td>4.510417</td>
      <td>2304</td>
    </tr>
    <tr>
      <th>Shawshank Redemption, The (1994)</th>
      <td>4.554558</td>
      <td>2227</td>
    </tr>
    <tr>
      <th>Usual Suspects, The (1995)</th>
      <td>4.517106</td>
      <td>1783</td>
    </tr>
  </tbody>
</table>
</div>



## [실습 #1] 여자들이 좋아하는 영화 찾기 
### - 여성 평점이 4.0 이상이고 여성 평점의 개수가 500개 이상인 영화


```python
data_f = data[data['성별']=='F']
data_f
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>7</th>
      <td>24</td>
      <td>F</td>
      <td>25</td>
      <td>7</td>
      <td>10023</td>
      <td>1193</td>
      <td>5</td>
      <td>978136709</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>8</th>
      <td>28</td>
      <td>F</td>
      <td>25</td>
      <td>1</td>
      <td>14607</td>
      <td>1193</td>
      <td>3</td>
      <td>978125194</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>19</th>
      <td>59</td>
      <td>F</td>
      <td>50</td>
      <td>1</td>
      <td>55413</td>
      <td>1193</td>
      <td>4</td>
      <td>977934292</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000199</th>
      <td>5334</td>
      <td>F</td>
      <td>56</td>
      <td>13</td>
      <td>46140</td>
      <td>3382</td>
      <td>5</td>
      <td>960796159</td>
      <td>Song of Freedom (1936)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1000200</th>
      <td>5420</td>
      <td>F</td>
      <td>1</td>
      <td>19</td>
      <td>14850</td>
      <td>1843</td>
      <td>3</td>
      <td>960156505</td>
      <td>Slappy and the Stinkers (1998)</td>
      <td>Children's|Comedy</td>
    </tr>
    <tr>
      <th>1000201</th>
      <td>5433</td>
      <td>F</td>
      <td>35</td>
      <td>17</td>
      <td>45014</td>
      <td>286</td>
      <td>3</td>
      <td>960240881</td>
      <td>Nemesis 2: Nebula (1995)</td>
      <td>Action|Sci-Fi|Thriller</td>
    </tr>
    <tr>
      <th>1000202</th>
      <td>5494</td>
      <td>F</td>
      <td>35</td>
      <td>17</td>
      <td>94306</td>
      <td>3530</td>
      <td>4</td>
      <td>959816296</td>
      <td>Smoking/No Smoking (1993)</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>One Little Indian (1973)</td>
      <td>Comedy|Drama|Western</td>
    </tr>
  </tbody>
</table>
<p>246440 rows × 10 columns</p>
</div>




```python
여성평점 = data_f.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')
여성평점.columns=['평점평균','평점개수']
```


```python
여성평점[(여성평점.평점평균 >= 4.0) & (여성평점.평점개수 >=500)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균</th>
      <th>평점개수</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>American Beauty (1999)</th>
      <td>4.238901</td>
      <td>946</td>
    </tr>
    <tr>
      <th>Being John Malkovich (1999)</th>
      <td>4.159930</td>
      <td>569</td>
    </tr>
    <tr>
      <th>Braveheart (1995)</th>
      <td>4.016484</td>
      <td>546</td>
    </tr>
    <tr>
      <th>Casablanca (1942)</th>
      <td>4.300990</td>
      <td>505</td>
    </tr>
    <tr>
      <th>E.T. the Extra-Terrestrial (1982)</th>
      <td>4.089850</td>
      <td>601</td>
    </tr>
    <tr>
      <th>Fargo (1996)</th>
      <td>4.217656</td>
      <td>657</td>
    </tr>
    <tr>
      <th>Forrest Gump (1994)</th>
      <td>4.045031</td>
      <td>644</td>
    </tr>
    <tr>
      <th>L.A. Confidential (1997)</th>
      <td>4.106007</td>
      <td>566</td>
    </tr>
    <tr>
      <th>Matrix, The (1999)</th>
      <td>4.128405</td>
      <td>514</td>
    </tr>
    <tr>
      <th>Princess Bride, The (1987)</th>
      <td>4.342767</td>
      <td>636</td>
    </tr>
    <tr>
      <th>Pulp Fiction (1994)</th>
      <td>4.071956</td>
      <td>542</td>
    </tr>
    <tr>
      <th>Raiders of the Lost Ark (1981)</th>
      <td>4.332168</td>
      <td>572</td>
    </tr>
    <tr>
      <th>Saving Private Ryan (1998)</th>
      <td>4.114783</td>
      <td>575</td>
    </tr>
    <tr>
      <th>Schindler's List (1993)</th>
      <td>4.562602</td>
      <td>615</td>
    </tr>
    <tr>
      <th>Shakespeare in Love (1998)</th>
      <td>4.181704</td>
      <td>798</td>
    </tr>
    <tr>
      <th>Shawshank Redemption, The (1994)</th>
      <td>4.539075</td>
      <td>627</td>
    </tr>
    <tr>
      <th>Silence of the Lambs, The (1991)</th>
      <td>4.271955</td>
      <td>706</td>
    </tr>
    <tr>
      <th>Sixth Sense, The (1999)</th>
      <td>4.477410</td>
      <td>664</td>
    </tr>
    <tr>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <td>4.302937</td>
      <td>647</td>
    </tr>
    <tr>
      <th>Star Wars: Episode V - The Empire Strikes Back (1980)</th>
      <td>4.106481</td>
      <td>648</td>
    </tr>
    <tr>
      <th>Toy Story (1995)</th>
      <td>4.187817</td>
      <td>591</td>
    </tr>
    <tr>
      <th>Wizard of Oz, The (1939)</th>
      <td>4.355030</td>
      <td>507</td>
    </tr>
  </tbody>
</table>
</div>




```python

```


```python
data[data['성별']=='F'].pivot_table(index='영화제목', 
                                  aggfunc=['mean','count'], values='평점')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th></th>
      <th>평점</th>
      <th>평점</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$1,000,000 Duck (1971)</th>
      <td>3.375000</td>
      <td>16</td>
    </tr>
    <tr>
      <th>'Night Mother (1986)</th>
      <td>3.388889</td>
      <td>36</td>
    </tr>
    <tr>
      <th>'Til There Was You (1997)</th>
      <td>2.675676</td>
      <td>37</td>
    </tr>
    <tr>
      <th>'burbs, The (1989)</th>
      <td>2.793478</td>
      <td>92</td>
    </tr>
    <tr>
      <th>...And Justice for All (1979)</th>
      <td>3.828571</td>
      <td>35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Your Friends and Neighbors (1998)</th>
      <td>2.888889</td>
      <td>27</td>
    </tr>
    <tr>
      <th>Zed &amp; Two Noughts, A (1985)</th>
      <td>3.500000</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Zero Effect (1998)</th>
      <td>3.864407</td>
      <td>59</td>
    </tr>
    <tr>
      <th>Zeus and Roxanne (1997)</th>
      <td>2.777778</td>
      <td>9</td>
    </tr>
    <tr>
      <th>eXistenZ (1999)</th>
      <td>3.098592</td>
      <td>71</td>
    </tr>
  </tbody>
</table>
<p>3481 rows × 2 columns</p>
</div>




```python
ex1 = data.pivot_table(index='영화제목', columns='성별',                       
                       aggfunc=['mean','count'], values='평점')
ex1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">count</th>
    </tr>
    <tr>
      <th>성별</th>
      <th>F</th>
      <th>M</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$1,000,000 Duck (1971)</th>
      <td>3.375000</td>
      <td>2.761905</td>
      <td>16.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>'Night Mother (1986)</th>
      <td>3.388889</td>
      <td>3.352941</td>
      <td>36.0</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>'Til There Was You (1997)</th>
      <td>2.675676</td>
      <td>2.733333</td>
      <td>37.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>'burbs, The (1989)</th>
      <td>2.793478</td>
      <td>2.962085</td>
      <td>92.0</td>
      <td>211.0</td>
    </tr>
    <tr>
      <th>...And Justice for All (1979)</th>
      <td>3.828571</td>
      <td>3.689024</td>
      <td>35.0</td>
      <td>164.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zed &amp; Two Noughts, A (1985)</th>
      <td>3.500000</td>
      <td>3.380952</td>
      <td>8.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Zero Effect (1998)</th>
      <td>3.864407</td>
      <td>3.723140</td>
      <td>59.0</td>
      <td>242.0</td>
    </tr>
    <tr>
      <th>Zero Kelvin (Kjærlighetens kjøtere) (1995)</th>
      <td>NaN</td>
      <td>3.500000</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Zeus and Roxanne (1997)</th>
      <td>2.777778</td>
      <td>2.357143</td>
      <td>9.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>eXistenZ (1999)</th>
      <td>3.098592</td>
      <td>3.289086</td>
      <td>71.0</td>
      <td>339.0</td>
    </tr>
  </tbody>
</table>
<p>3706 rows × 4 columns</p>
</div>




```python
ex1[(ex1[('mean','F')]>= 4.0) & (ex1[('count','F')] >=500)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">count</th>
    </tr>
    <tr>
      <th>성별</th>
      <th>F</th>
      <th>M</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>American Beauty (1999)</th>
      <td>4.238901</td>
      <td>4.347301</td>
      <td>946.0</td>
      <td>2482.0</td>
    </tr>
    <tr>
      <th>Being John Malkovich (1999)</th>
      <td>4.159930</td>
      <td>4.113636</td>
      <td>569.0</td>
      <td>1672.0</td>
    </tr>
    <tr>
      <th>Braveheart (1995)</th>
      <td>4.016484</td>
      <td>4.297839</td>
      <td>546.0</td>
      <td>1897.0</td>
    </tr>
    <tr>
      <th>Casablanca (1942)</th>
      <td>4.300990</td>
      <td>4.461340</td>
      <td>505.0</td>
      <td>1164.0</td>
    </tr>
    <tr>
      <th>E.T. the Extra-Terrestrial (1982)</th>
      <td>4.089850</td>
      <td>3.920264</td>
      <td>601.0</td>
      <td>1668.0</td>
    </tr>
    <tr>
      <th>Fargo (1996)</th>
      <td>4.217656</td>
      <td>4.267780</td>
      <td>657.0</td>
      <td>1856.0</td>
    </tr>
    <tr>
      <th>Forrest Gump (1994)</th>
      <td>4.045031</td>
      <td>4.105806</td>
      <td>644.0</td>
      <td>1550.0</td>
    </tr>
    <tr>
      <th>L.A. Confidential (1997)</th>
      <td>4.106007</td>
      <td>4.256678</td>
      <td>566.0</td>
      <td>1722.0</td>
    </tr>
    <tr>
      <th>Matrix, The (1999)</th>
      <td>4.128405</td>
      <td>4.362235</td>
      <td>514.0</td>
      <td>2076.0</td>
    </tr>
    <tr>
      <th>Princess Bride, The (1987)</th>
      <td>4.342767</td>
      <td>4.288942</td>
      <td>636.0</td>
      <td>1682.0</td>
    </tr>
    <tr>
      <th>Pulp Fiction (1994)</th>
      <td>4.071956</td>
      <td>4.346839</td>
      <td>542.0</td>
      <td>1629.0</td>
    </tr>
    <tr>
      <th>Raiders of the Lost Ark (1981)</th>
      <td>4.332168</td>
      <td>4.520597</td>
      <td>572.0</td>
      <td>1942.0</td>
    </tr>
    <tr>
      <th>Saving Private Ryan (1998)</th>
      <td>4.114783</td>
      <td>4.398941</td>
      <td>575.0</td>
      <td>2078.0</td>
    </tr>
    <tr>
      <th>Schindler's List (1993)</th>
      <td>4.562602</td>
      <td>4.491415</td>
      <td>615.0</td>
      <td>1689.0</td>
    </tr>
    <tr>
      <th>Shakespeare in Love (1998)</th>
      <td>4.181704</td>
      <td>4.099936</td>
      <td>798.0</td>
      <td>1571.0</td>
    </tr>
    <tr>
      <th>Shawshank Redemption, The (1994)</th>
      <td>4.539075</td>
      <td>4.560625</td>
      <td>627.0</td>
      <td>1600.0</td>
    </tr>
    <tr>
      <th>Silence of the Lambs, The (1991)</th>
      <td>4.271955</td>
      <td>4.381944</td>
      <td>706.0</td>
      <td>1872.0</td>
    </tr>
    <tr>
      <th>Sixth Sense, The (1999)</th>
      <td>4.477410</td>
      <td>4.379944</td>
      <td>664.0</td>
      <td>1795.0</td>
    </tr>
    <tr>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <td>4.302937</td>
      <td>4.495307</td>
      <td>647.0</td>
      <td>2344.0</td>
    </tr>
    <tr>
      <th>Star Wars: Episode V - The Empire Strikes Back (1980)</th>
      <td>4.106481</td>
      <td>4.344577</td>
      <td>648.0</td>
      <td>2342.0</td>
    </tr>
    <tr>
      <th>Toy Story (1995)</th>
      <td>4.187817</td>
      <td>4.130552</td>
      <td>591.0</td>
      <td>1486.0</td>
    </tr>
    <tr>
      <th>Wizard of Oz, The (1939)</th>
      <td>4.355030</td>
      <td>4.203138</td>
      <td>507.0</td>
      <td>1211.0</td>
    </tr>
  </tbody>
</table>
</div>



## [실습 #2] 실습 #1에서 구한 영화(여성인기영화)의 장르를 분석해 보자.
여성인기영화의 장르 통계 구하기

예를 들어, 여성인기영화 중 Drama 장르의 영화는 10개, Action 영화는 3개, ...


```python
여성인기영화 = 여성평점[(여성평점.평점평균 >= 4.0) & (여성평점.평점개수 >=500)]
여성인기영화
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균</th>
      <th>평점개수</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>American Beauty (1999)</th>
      <td>4.238901</td>
      <td>946</td>
    </tr>
    <tr>
      <th>Being John Malkovich (1999)</th>
      <td>4.159930</td>
      <td>569</td>
    </tr>
    <tr>
      <th>Braveheart (1995)</th>
      <td>4.016484</td>
      <td>546</td>
    </tr>
    <tr>
      <th>Casablanca (1942)</th>
      <td>4.300990</td>
      <td>505</td>
    </tr>
    <tr>
      <th>E.T. the Extra-Terrestrial (1982)</th>
      <td>4.089850</td>
      <td>601</td>
    </tr>
    <tr>
      <th>Fargo (1996)</th>
      <td>4.217656</td>
      <td>657</td>
    </tr>
    <tr>
      <th>Forrest Gump (1994)</th>
      <td>4.045031</td>
      <td>644</td>
    </tr>
    <tr>
      <th>L.A. Confidential (1997)</th>
      <td>4.106007</td>
      <td>566</td>
    </tr>
    <tr>
      <th>Matrix, The (1999)</th>
      <td>4.128405</td>
      <td>514</td>
    </tr>
    <tr>
      <th>Princess Bride, The (1987)</th>
      <td>4.342767</td>
      <td>636</td>
    </tr>
    <tr>
      <th>Pulp Fiction (1994)</th>
      <td>4.071956</td>
      <td>542</td>
    </tr>
    <tr>
      <th>Raiders of the Lost Ark (1981)</th>
      <td>4.332168</td>
      <td>572</td>
    </tr>
    <tr>
      <th>Saving Private Ryan (1998)</th>
      <td>4.114783</td>
      <td>575</td>
    </tr>
    <tr>
      <th>Schindler's List (1993)</th>
      <td>4.562602</td>
      <td>615</td>
    </tr>
    <tr>
      <th>Shakespeare in Love (1998)</th>
      <td>4.181704</td>
      <td>798</td>
    </tr>
    <tr>
      <th>Shawshank Redemption, The (1994)</th>
      <td>4.539075</td>
      <td>627</td>
    </tr>
    <tr>
      <th>Silence of the Lambs, The (1991)</th>
      <td>4.271955</td>
      <td>706</td>
    </tr>
    <tr>
      <th>Sixth Sense, The (1999)</th>
      <td>4.477410</td>
      <td>664</td>
    </tr>
    <tr>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <td>4.302937</td>
      <td>647</td>
    </tr>
    <tr>
      <th>Star Wars: Episode V - The Empire Strikes Back (1980)</th>
      <td>4.106481</td>
      <td>648</td>
    </tr>
    <tr>
      <th>Toy Story (1995)</th>
      <td>4.187817</td>
      <td>591</td>
    </tr>
    <tr>
      <th>Wizard of Oz, The (1939)</th>
      <td>4.355030</td>
      <td>507</td>
    </tr>
  </tbody>
</table>
</div>




```python
여성인기영화.index
```




    Index(['American Beauty (1999)', 'Being John Malkovich (1999)',
           'Braveheart (1995)', 'Casablanca (1942)',
           'E.T. the Extra-Terrestrial (1982)', 'Fargo (1996)',
           'Forrest Gump (1994)', 'L.A. Confidential (1997)', 'Matrix, The (1999)',
           'Princess Bride, The (1987)', 'Pulp Fiction (1994)',
           'Raiders of the Lost Ark (1981)', 'Saving Private Ryan (1998)',
           'Schindler's List (1993)', 'Shakespeare in Love (1998)',
           'Shawshank Redemption, The (1994)', 'Silence of the Lambs, The (1991)',
           'Sixth Sense, The (1999)', 'Star Wars: Episode IV - A New Hope (1977)',
           'Star Wars: Episode V - The Empire Strikes Back (1980)',
           'Toy Story (1995)', 'Wizard of Oz, The (1939)'],
          dtype='object', name='영화제목')




```python
movies.영화제목.values
```




    array(['Toy Story (1995)', 'Jumanji (1995)', 'Grumpier Old Men (1995)',
           ..., 'Tigerland (2000)', 'Two Family House (2000)',
           'Contender, The (2000)'], dtype=object)




```python
lst=[]
for i in 여성인기영화.index:
    if i in movies.영화제목.values:
        lst.append(i)
lst
```




    ['American Beauty (1999)',
     'Being John Malkovich (1999)',
     'Braveheart (1995)',
     'Casablanca (1942)',
     'E.T. the Extra-Terrestrial (1982)',
     'Fargo (1996)',
     'Forrest Gump (1994)',
     'L.A. Confidential (1997)',
     'Matrix, The (1999)',
     'Princess Bride, The (1987)',
     'Pulp Fiction (1994)',
     'Raiders of the Lost Ark (1981)',
     'Saving Private Ryan (1998)',
     "Schindler's List (1993)",
     'Shakespeare in Love (1998)',
     'Shawshank Redemption, The (1994)',
     'Silence of the Lambs, The (1991)',
     'Sixth Sense, The (1999)',
     'Star Wars: Episode IV - A New Hope (1977)',
     'Star Wars: Episode V - The Empire Strikes Back (1980)',
     'Toy Story (1995)',
     'Wizard of Oz, The (1939)']




```python
여성인기영화장르 = movies[movies.영화제목.isin(lst)]
여성인기영화장르
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>영화아이디</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>108</th>
      <td>110</td>
      <td>Braveheart (1995)</td>
      <td>Action|Drama|War</td>
    </tr>
    <tr>
      <th>257</th>
      <td>260</td>
      <td>Star Wars: Episode IV - A New Hope (1977)</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
    </tr>
    <tr>
      <th>293</th>
      <td>296</td>
      <td>Pulp Fiction (1994)</td>
      <td>Crime|Drama</td>
    </tr>
    <tr>
      <th>315</th>
      <td>318</td>
      <td>Shawshank Redemption, The (1994)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>352</th>
      <td>356</td>
      <td>Forrest Gump (1994)</td>
      <td>Comedy|Romance|War</td>
    </tr>
    <tr>
      <th>523</th>
      <td>527</td>
      <td>Schindler's List (1993)</td>
      <td>Drama|War</td>
    </tr>
    <tr>
      <th>589</th>
      <td>593</td>
      <td>Silence of the Lambs, The (1991)</td>
      <td>Drama|Thriller</td>
    </tr>
    <tr>
      <th>604</th>
      <td>608</td>
      <td>Fargo (1996)</td>
      <td>Crime|Drama|Thriller</td>
    </tr>
    <tr>
      <th>900</th>
      <td>912</td>
      <td>Casablanca (1942)</td>
      <td>Drama|Romance|War</td>
    </tr>
    <tr>
      <th>907</th>
      <td>919</td>
      <td>Wizard of Oz, The (1939)</td>
      <td>Adventure|Children's|Drama|Musical</td>
    </tr>
    <tr>
      <th>1081</th>
      <td>1097</td>
      <td>E.T. the Extra-Terrestrial (1982)</td>
      <td>Children's|Drama|Fantasy|Sci-Fi</td>
    </tr>
    <tr>
      <th>1178</th>
      <td>1196</td>
      <td>Star Wars: Episode V - The Empire Strikes Back...</td>
      <td>Action|Adventure|Drama|Sci-Fi|War</td>
    </tr>
    <tr>
      <th>1179</th>
      <td>1197</td>
      <td>Princess Bride, The (1987)</td>
      <td>Action|Adventure|Comedy|Romance</td>
    </tr>
    <tr>
      <th>1180</th>
      <td>1198</td>
      <td>Raiders of the Lost Ark (1981)</td>
      <td>Action|Adventure</td>
    </tr>
    <tr>
      <th>1575</th>
      <td>1617</td>
      <td>L.A. Confidential (1997)</td>
      <td>Crime|Film-Noir|Mystery|Thriller</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>2028</td>
      <td>Saving Private Ryan (1998)</td>
      <td>Action|Drama|War</td>
    </tr>
    <tr>
      <th>2327</th>
      <td>2396</td>
      <td>Shakespeare in Love (1998)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>2502</th>
      <td>2571</td>
      <td>Matrix, The (1999)</td>
      <td>Action|Sci-Fi|Thriller</td>
    </tr>
    <tr>
      <th>2693</th>
      <td>2762</td>
      <td>Sixth Sense, The (1999)</td>
      <td>Thriller</td>
    </tr>
    <tr>
      <th>2789</th>
      <td>2858</td>
      <td>American Beauty (1999)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>2997</td>
      <td>Being John Malkovich (1999)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
k =[]
for i in 여성인기영화장르.장르:
    for j in i.split('|'):
        k.append(j)
```


```python
k
```




    ['Animation',
     "Children's",
     'Comedy',
     'Action',
     'Drama',
     'War',
     'Action',
     'Adventure',
     'Fantasy',
     'Sci-Fi',
     'Crime',
     'Drama',
     'Drama',
     'Comedy',
     'Romance',
     'War',
     'Drama',
     'War',
     'Drama',
     'Thriller',
     'Crime',
     'Drama',
     'Thriller',
     'Drama',
     'Romance',
     'War',
     'Adventure',
     "Children's",
     'Drama',
     'Musical',
     "Children's",
     'Drama',
     'Fantasy',
     'Sci-Fi',
     'Action',
     'Adventure',
     'Drama',
     'Sci-Fi',
     'War',
     'Action',
     'Adventure',
     'Comedy',
     'Romance',
     'Action',
     'Adventure',
     'Crime',
     'Film-Noir',
     'Mystery',
     'Thriller',
     'Action',
     'Drama',
     'War',
     'Comedy',
     'Romance',
     'Action',
     'Sci-Fi',
     'Thriller',
     'Thriller',
     'Comedy',
     'Drama',
     'Comedy']




```python
count={}
for i in k:
    try: count[i] += 1
    except: count[i]=1
print(count)
```

    {'Animation': 1, "Children's": 3, 'Comedy': 6, 'Action': 7, 'Drama': 12, 'War': 6, 'Adventure': 5, 'Fantasy': 2, 'Sci-Fi': 4, 'Crime': 3, 'Romance': 4, 'Thriller': 5, 'Musical': 1, 'Film-Noir': 1, 'Mystery': 1}
    


```python

```


```python
ex2 = ex1[(ex1[('mean','F')]>= 4.0) & (ex1[('count','F')] >=500)].index
```


```python
ex2
```




    Index(['American Beauty (1999)', 'Being John Malkovich (1999)',
           'Braveheart (1995)', 'Casablanca (1942)',
           'E.T. the Extra-Terrestrial (1982)', 'Fargo (1996)',
           'Forrest Gump (1994)', 'L.A. Confidential (1997)', 'Matrix, The (1999)',
           'Princess Bride, The (1987)', 'Pulp Fiction (1994)',
           'Raiders of the Lost Ark (1981)', 'Saving Private Ryan (1998)',
           'Schindler's List (1993)', 'Shakespeare in Love (1998)',
           'Shawshank Redemption, The (1994)', 'Silence of the Lambs, The (1991)',
           'Sixth Sense, The (1999)', 'Star Wars: Episode IV - A New Hope (1977)',
           'Star Wars: Episode V - The Empire Strikes Back (1980)',
           'Toy Story (1995)', 'Wizard of Oz, The (1939)'],
          dtype='object', name='영화제목')




```python
ex2_df = movies[movies.영화제목.isin(ex2)]
ex2_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>영화아이디</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>108</th>
      <td>110</td>
      <td>Braveheart (1995)</td>
      <td>Action|Drama|War</td>
    </tr>
    <tr>
      <th>257</th>
      <td>260</td>
      <td>Star Wars: Episode IV - A New Hope (1977)</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
    </tr>
    <tr>
      <th>293</th>
      <td>296</td>
      <td>Pulp Fiction (1994)</td>
      <td>Crime|Drama</td>
    </tr>
    <tr>
      <th>315</th>
      <td>318</td>
      <td>Shawshank Redemption, The (1994)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>352</th>
      <td>356</td>
      <td>Forrest Gump (1994)</td>
      <td>Comedy|Romance|War</td>
    </tr>
    <tr>
      <th>523</th>
      <td>527</td>
      <td>Schindler's List (1993)</td>
      <td>Drama|War</td>
    </tr>
    <tr>
      <th>589</th>
      <td>593</td>
      <td>Silence of the Lambs, The (1991)</td>
      <td>Drama|Thriller</td>
    </tr>
    <tr>
      <th>604</th>
      <td>608</td>
      <td>Fargo (1996)</td>
      <td>Crime|Drama|Thriller</td>
    </tr>
    <tr>
      <th>900</th>
      <td>912</td>
      <td>Casablanca (1942)</td>
      <td>Drama|Romance|War</td>
    </tr>
    <tr>
      <th>907</th>
      <td>919</td>
      <td>Wizard of Oz, The (1939)</td>
      <td>Adventure|Children's|Drama|Musical</td>
    </tr>
    <tr>
      <th>1081</th>
      <td>1097</td>
      <td>E.T. the Extra-Terrestrial (1982)</td>
      <td>Children's|Drama|Fantasy|Sci-Fi</td>
    </tr>
    <tr>
      <th>1178</th>
      <td>1196</td>
      <td>Star Wars: Episode V - The Empire Strikes Back...</td>
      <td>Action|Adventure|Drama|Sci-Fi|War</td>
    </tr>
    <tr>
      <th>1179</th>
      <td>1197</td>
      <td>Princess Bride, The (1987)</td>
      <td>Action|Adventure|Comedy|Romance</td>
    </tr>
    <tr>
      <th>1180</th>
      <td>1198</td>
      <td>Raiders of the Lost Ark (1981)</td>
      <td>Action|Adventure</td>
    </tr>
    <tr>
      <th>1575</th>
      <td>1617</td>
      <td>L.A. Confidential (1997)</td>
      <td>Crime|Film-Noir|Mystery|Thriller</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>2028</td>
      <td>Saving Private Ryan (1998)</td>
      <td>Action|Drama|War</td>
    </tr>
    <tr>
      <th>2327</th>
      <td>2396</td>
      <td>Shakespeare in Love (1998)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>2502</th>
      <td>2571</td>
      <td>Matrix, The (1999)</td>
      <td>Action|Sci-Fi|Thriller</td>
    </tr>
    <tr>
      <th>2693</th>
      <td>2762</td>
      <td>Sixth Sense, The (1999)</td>
      <td>Thriller</td>
    </tr>
    <tr>
      <th>2789</th>
      <td>2858</td>
      <td>American Beauty (1999)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>2997</td>
      <td>Being John Malkovich (1999)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
ex2_df.장르.str.split('|')
```




    0               [Animation, Children's, Comedy]
    108                        [Action, Drama, War]
    257        [Action, Adventure, Fantasy, Sci-Fi]
    293                              [Crime, Drama]
    315                                     [Drama]
    352                      [Comedy, Romance, War]
    523                                [Drama, War]
    589                           [Drama, Thriller]
    604                    [Crime, Drama, Thriller]
    900                       [Drama, Romance, War]
    907     [Adventure, Children's, Drama, Musical]
    1081       [Children's, Drama, Fantasy, Sci-Fi]
    1178    [Action, Adventure, Drama, Sci-Fi, War]
    1179       [Action, Adventure, Comedy, Romance]
    1180                        [Action, Adventure]
    1575      [Crime, Film-Noir, Mystery, Thriller]
    1959                       [Action, Drama, War]
    2327                          [Comedy, Romance]
    2502                 [Action, Sci-Fi, Thriller]
    2693                                 [Thriller]
    2789                            [Comedy, Drama]
    2928                                   [Comedy]
    Name: 장르, dtype: object




```python
ex2_df = ex2_df.장르.str.split('|', expand=True)
ex2_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Animation</td>
      <td>Children's</td>
      <td>Comedy</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>108</th>
      <td>Action</td>
      <td>Drama</td>
      <td>War</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>257</th>
      <td>Action</td>
      <td>Adventure</td>
      <td>Fantasy</td>
      <td>Sci-Fi</td>
      <td>None</td>
    </tr>
    <tr>
      <th>293</th>
      <td>Crime</td>
      <td>Drama</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>315</th>
      <td>Drama</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>352</th>
      <td>Comedy</td>
      <td>Romance</td>
      <td>War</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>523</th>
      <td>Drama</td>
      <td>War</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>589</th>
      <td>Drama</td>
      <td>Thriller</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>604</th>
      <td>Crime</td>
      <td>Drama</td>
      <td>Thriller</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>900</th>
      <td>Drama</td>
      <td>Romance</td>
      <td>War</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>907</th>
      <td>Adventure</td>
      <td>Children's</td>
      <td>Drama</td>
      <td>Musical</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1081</th>
      <td>Children's</td>
      <td>Drama</td>
      <td>Fantasy</td>
      <td>Sci-Fi</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1178</th>
      <td>Action</td>
      <td>Adventure</td>
      <td>Drama</td>
      <td>Sci-Fi</td>
      <td>War</td>
    </tr>
    <tr>
      <th>1179</th>
      <td>Action</td>
      <td>Adventure</td>
      <td>Comedy</td>
      <td>Romance</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1180</th>
      <td>Action</td>
      <td>Adventure</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1575</th>
      <td>Crime</td>
      <td>Film-Noir</td>
      <td>Mystery</td>
      <td>Thriller</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1959</th>
      <td>Action</td>
      <td>Drama</td>
      <td>War</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2327</th>
      <td>Comedy</td>
      <td>Romance</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2502</th>
      <td>Action</td>
      <td>Sci-Fi</td>
      <td>Thriller</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2693</th>
      <td>Thriller</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2789</th>
      <td>Comedy</td>
      <td>Drama</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2928</th>
      <td>Comedy</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>




```python
장르1 = ex2_df[0].value_counts()
장르2 = ex2_df[1].value_counts()
장르3 = ex2_df[2].value_counts()
장르4 = ex2_df[3].value_counts()
장르5 = ex2_df[4].value_counts()
```


```python
#장르1+장르2+장르3+장르4+장르5
장르1.add(장르2, fill_value=0).add(장르3, fill_value=0).add(장르4, fill_value=0).add(장르5, fill_value=0)
```




    Action         7.0
    Adventure      5.0
    Animation      1.0
    Children's     3.0
    Comedy         6.0
    Crime          3.0
    Drama         12.0
    Fantasy        2.0
    Film-Noir      1.0
    Musical        1.0
    Mystery        1.0
    Romance        4.0
    Sci-Fi         4.0
    Thriller       5.0
    War            6.0
    dtype: float64




```python
sr = Series()
for col in ex2_df.columns:
    sr = sr.add(ex2_df[col].value_counts(), fill_value=0)
sr
```

    C:\anaconda\envs\test3\lib\site-packages\ipykernel_launcher.py:1: DeprecationWarning: The default dtype for empty Series will be 'object' instead of 'float64' in a future version. Specify a dtype explicitly to silence this warning.
      """Entry point for launching an IPython kernel.
    




    Action         7.0
    Adventure      5.0
    Animation      1.0
    Children's     3.0
    Comedy         6.0
    Crime          3.0
    Drama         12.0
    Fantasy        2.0
    Film-Noir      1.0
    Musical        1.0
    Mystery        1.0
    Romance        4.0
    Sci-Fi         4.0
    Thriller       5.0
    War            6.0
    dtype: float64




```python
sr.sort_values(ascending=False)
```




    Drama         12.0
    Action         7.0
    Comedy         6.0
    War            6.0
    Adventure      5.0
    Thriller       5.0
    Romance        4.0
    Sci-Fi         4.0
    Children's     3.0
    Crime          3.0
    Fantasy        2.0
    Animation      1.0
    Film-Noir      1.0
    Musical        1.0
    Mystery        1.0
    dtype: float64




```python

```

## [실습 #3] 남자와 여자의 호불호가 크게 갈리는 영화 10개 찾기
전체 평점의 개수가 500개 이상인 영화만 대상으로 함.


```python
data_f = data[data['성별']=='F']
data_f
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18</td>
      <td>F</td>
      <td>18</td>
      <td>3</td>
      <td>95825</td>
      <td>1193</td>
      <td>4</td>
      <td>978156168</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>7</th>
      <td>24</td>
      <td>F</td>
      <td>25</td>
      <td>7</td>
      <td>10023</td>
      <td>1193</td>
      <td>5</td>
      <td>978136709</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>8</th>
      <td>28</td>
      <td>F</td>
      <td>25</td>
      <td>1</td>
      <td>14607</td>
      <td>1193</td>
      <td>3</td>
      <td>978125194</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>19</th>
      <td>59</td>
      <td>F</td>
      <td>50</td>
      <td>1</td>
      <td>55413</td>
      <td>1193</td>
      <td>4</td>
      <td>977934292</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000199</th>
      <td>5334</td>
      <td>F</td>
      <td>56</td>
      <td>13</td>
      <td>46140</td>
      <td>3382</td>
      <td>5</td>
      <td>960796159</td>
      <td>Song of Freedom (1936)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1000200</th>
      <td>5420</td>
      <td>F</td>
      <td>1</td>
      <td>19</td>
      <td>14850</td>
      <td>1843</td>
      <td>3</td>
      <td>960156505</td>
      <td>Slappy and the Stinkers (1998)</td>
      <td>Children's|Comedy</td>
    </tr>
    <tr>
      <th>1000201</th>
      <td>5433</td>
      <td>F</td>
      <td>35</td>
      <td>17</td>
      <td>45014</td>
      <td>286</td>
      <td>3</td>
      <td>960240881</td>
      <td>Nemesis 2: Nebula (1995)</td>
      <td>Action|Sci-Fi|Thriller</td>
    </tr>
    <tr>
      <th>1000202</th>
      <td>5494</td>
      <td>F</td>
      <td>35</td>
      <td>17</td>
      <td>94306</td>
      <td>3530</td>
      <td>4</td>
      <td>959816296</td>
      <td>Smoking/No Smoking (1993)</td>
      <td>Comedy</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>One Little Indian (1973)</td>
      <td>Comedy|Drama|Western</td>
    </tr>
  </tbody>
</table>
<p>246440 rows × 10 columns</p>
</div>




```python
여성평점 = data_f.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')
여성평점.columns=['평점평균_f','평점개수_f']
여성평점 = 여성평점[여성평점.평점개수_f >=500]
여성평점
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균_f</th>
      <th>평점개수_f</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>American Beauty (1999)</th>
      <td>4.238901</td>
      <td>946</td>
    </tr>
    <tr>
      <th>Babe (1995)</th>
      <td>3.953368</td>
      <td>579</td>
    </tr>
    <tr>
      <th>Back to the Future (1985)</th>
      <td>3.932707</td>
      <td>639</td>
    </tr>
    <tr>
      <th>Being John Malkovich (1999)</th>
      <td>4.159930</td>
      <td>569</td>
    </tr>
    <tr>
      <th>Braveheart (1995)</th>
      <td>4.016484</td>
      <td>546</td>
    </tr>
    <tr>
      <th>Casablanca (1942)</th>
      <td>4.300990</td>
      <td>505</td>
    </tr>
    <tr>
      <th>E.T. the Extra-Terrestrial (1982)</th>
      <td>4.089850</td>
      <td>601</td>
    </tr>
    <tr>
      <th>Fargo (1996)</th>
      <td>4.217656</td>
      <td>657</td>
    </tr>
    <tr>
      <th>Forrest Gump (1994)</th>
      <td>4.045031</td>
      <td>644</td>
    </tr>
    <tr>
      <th>Ghostbusters (1984)</th>
      <td>3.833962</td>
      <td>530</td>
    </tr>
    <tr>
      <th>Groundhog Day (1993)</th>
      <td>3.735562</td>
      <td>658</td>
    </tr>
    <tr>
      <th>Jurassic Park (1993)</th>
      <td>3.579407</td>
      <td>573</td>
    </tr>
    <tr>
      <th>L.A. Confidential (1997)</th>
      <td>4.106007</td>
      <td>566</td>
    </tr>
    <tr>
      <th>Matrix, The (1999)</th>
      <td>4.128405</td>
      <td>514</td>
    </tr>
    <tr>
      <th>Men in Black (1997)</th>
      <td>3.817844</td>
      <td>538</td>
    </tr>
    <tr>
      <th>Princess Bride, The (1987)</th>
      <td>4.342767</td>
      <td>636</td>
    </tr>
    <tr>
      <th>Pulp Fiction (1994)</th>
      <td>4.071956</td>
      <td>542</td>
    </tr>
    <tr>
      <th>Raiders of the Lost Ark (1981)</th>
      <td>4.332168</td>
      <td>572</td>
    </tr>
    <tr>
      <th>Saving Private Ryan (1998)</th>
      <td>4.114783</td>
      <td>575</td>
    </tr>
    <tr>
      <th>Schindler's List (1993)</th>
      <td>4.562602</td>
      <td>615</td>
    </tr>
    <tr>
      <th>Shakespeare in Love (1998)</th>
      <td>4.181704</td>
      <td>798</td>
    </tr>
    <tr>
      <th>Shawshank Redemption, The (1994)</th>
      <td>4.539075</td>
      <td>627</td>
    </tr>
    <tr>
      <th>Silence of the Lambs, The (1991)</th>
      <td>4.271955</td>
      <td>706</td>
    </tr>
    <tr>
      <th>Sixth Sense, The (1999)</th>
      <td>4.477410</td>
      <td>664</td>
    </tr>
    <tr>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <td>4.302937</td>
      <td>647</td>
    </tr>
    <tr>
      <th>Star Wars: Episode V - The Empire Strikes Back (1980)</th>
      <td>4.106481</td>
      <td>648</td>
    </tr>
    <tr>
      <th>Star Wars: Episode VI - Return of the Jedi (1983)</th>
      <td>3.865237</td>
      <td>653</td>
    </tr>
    <tr>
      <th>Toy Story (1995)</th>
      <td>4.187817</td>
      <td>591</td>
    </tr>
    <tr>
      <th>Wizard of Oz, The (1939)</th>
      <td>4.355030</td>
      <td>507</td>
    </tr>
  </tbody>
</table>
</div>




```python
data_m = data[data['성별']=='M']
data_m
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>6</th>
      <td>19</td>
      <td>M</td>
      <td>1</td>
      <td>10</td>
      <td>48073</td>
      <td>1193</td>
      <td>5</td>
      <td>982730936</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000203</th>
      <td>5556</td>
      <td>M</td>
      <td>45</td>
      <td>6</td>
      <td>92103</td>
      <td>2198</td>
      <td>3</td>
      <td>959445515</td>
      <td>Modulations (1998)</td>
      <td>Documentary</td>
    </tr>
    <tr>
      <th>1000204</th>
      <td>5949</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>47901</td>
      <td>2198</td>
      <td>5</td>
      <td>958846401</td>
      <td>Modulations (1998)</td>
      <td>Documentary</td>
    </tr>
    <tr>
      <th>1000205</th>
      <td>5675</td>
      <td>M</td>
      <td>35</td>
      <td>14</td>
      <td>30030</td>
      <td>2703</td>
      <td>3</td>
      <td>976029116</td>
      <td>Broken Vessels (1998)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1000206</th>
      <td>5780</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>92886</td>
      <td>2845</td>
      <td>1</td>
      <td>958153068</td>
      <td>White Boys (1999)</td>
      <td>Drama</td>
    </tr>
    <tr>
      <th>1000208</th>
      <td>5938</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>35401</td>
      <td>2909</td>
      <td>4</td>
      <td>957273353</td>
      <td>Five Wives, Three Secretaries and Me (1998)</td>
      <td>Documentary</td>
    </tr>
  </tbody>
</table>
<p>753769 rows × 10 columns</p>
</div>




```python
남성평점 = data_m.pivot_table(index='영화제목', aggfunc=['mean','count'], values='평점')
남성평점.columns=['평점평균_m','평점개수_m']
남성평점 = 남성평점[남성평점.평점개수_m >=500]
남성평점
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균_m</th>
      <th>평점개수_m</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13th Warrior, The (1999)</th>
      <td>3.168000</td>
      <td>625</td>
    </tr>
    <tr>
      <th>2001: A Space Odyssey (1968)</th>
      <td>4.129738</td>
      <td>1372</td>
    </tr>
    <tr>
      <th>Abyss, The (1989)</th>
      <td>3.689507</td>
      <td>1401</td>
    </tr>
    <tr>
      <th>Ace Ventura: Pet Detective (1994)</th>
      <td>3.197917</td>
      <td>576</td>
    </tr>
    <tr>
      <th>Addams Family, The (1991)</th>
      <td>3.163498</td>
      <td>526</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Wrong Trousers, The (1993)</th>
      <td>4.478261</td>
      <td>644</td>
    </tr>
    <tr>
      <th>X-Files: Fight the Future, The (1998)</th>
      <td>3.493797</td>
      <td>806</td>
    </tr>
    <tr>
      <th>X-Men (2000)</th>
      <td>3.851702</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>You've Got Mail (1998)</th>
      <td>3.275591</td>
      <td>508</td>
    </tr>
    <tr>
      <th>Young Frankenstein (1974)</th>
      <td>4.239177</td>
      <td>924</td>
    </tr>
  </tbody>
</table>
<p>436 rows × 2 columns</p>
</div>




```python
여남평점 = pd.concat([여성평점, 남성평점],axis=1)
여남평점['평점차이'] = abs(여남평점['평점평균_f']-여남평점['평점평균_m'])
여남평점.nlargest(10, ('평점차이'))
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>평점평균_f</th>
      <th>평점개수_f</th>
      <th>평점평균_m</th>
      <th>평점개수_m</th>
      <th>평점차이</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Groundhog Day (1993)</th>
      <td>3.735562</td>
      <td>658.0</td>
      <td>4.041358</td>
      <td>1620</td>
      <td>0.305796</td>
    </tr>
    <tr>
      <th>Saving Private Ryan (1998)</th>
      <td>4.114783</td>
      <td>575.0</td>
      <td>4.398941</td>
      <td>2078</td>
      <td>0.284159</td>
    </tr>
    <tr>
      <th>Braveheart (1995)</th>
      <td>4.016484</td>
      <td>546.0</td>
      <td>4.297839</td>
      <td>1897</td>
      <td>0.281355</td>
    </tr>
    <tr>
      <th>Pulp Fiction (1994)</th>
      <td>4.071956</td>
      <td>542.0</td>
      <td>4.346839</td>
      <td>1629</td>
      <td>0.274883</td>
    </tr>
    <tr>
      <th>Star Wars: Episode V - The Empire Strikes Back (1980)</th>
      <td>4.106481</td>
      <td>648.0</td>
      <td>4.344577</td>
      <td>2342</td>
      <td>0.238096</td>
    </tr>
    <tr>
      <th>Jurassic Park (1993)</th>
      <td>3.579407</td>
      <td>573.0</td>
      <td>3.814197</td>
      <td>2099</td>
      <td>0.234791</td>
    </tr>
    <tr>
      <th>Matrix, The (1999)</th>
      <td>4.128405</td>
      <td>514.0</td>
      <td>4.362235</td>
      <td>2076</td>
      <td>0.233830</td>
    </tr>
    <tr>
      <th>Star Wars: Episode VI - Return of the Jedi (1983)</th>
      <td>3.865237</td>
      <td>653.0</td>
      <td>4.069058</td>
      <td>2230</td>
      <td>0.203821</td>
    </tr>
    <tr>
      <th>Star Wars: Episode IV - A New Hope (1977)</th>
      <td>4.302937</td>
      <td>647.0</td>
      <td>4.495307</td>
      <td>2344</td>
      <td>0.192371</td>
    </tr>
    <tr>
      <th>Raiders of the Lost Ark (1981)</th>
      <td>4.332168</td>
      <td>572.0</td>
      <td>4.520597</td>
      <td>1942</td>
      <td>0.188429</td>
    </tr>
  </tbody>
</table>
</div>




```python

```


```python
ex3 = data.pivot_table(index = '영화제목', columns= '성별',
                      values = '평점', aggfunc = ['mean', 'count'])
```


```python
ex3 = ex3[ex3[('count','F')]+ex3[('count','M')]>=500]
ex3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">count</th>
    </tr>
    <tr>
      <th>성별</th>
      <th>F</th>
      <th>M</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10 Things I Hate About You (1999)</th>
      <td>3.646552</td>
      <td>3.311966</td>
      <td>232.0</td>
      <td>468.0</td>
    </tr>
    <tr>
      <th>101 Dalmatians (1961)</th>
      <td>3.791444</td>
      <td>3.500000</td>
      <td>187.0</td>
      <td>378.0</td>
    </tr>
    <tr>
      <th>12 Angry Men (1957)</th>
      <td>4.184397</td>
      <td>4.328421</td>
      <td>141.0</td>
      <td>475.0</td>
    </tr>
    <tr>
      <th>13th Warrior, The (1999)</th>
      <td>3.112000</td>
      <td>3.168000</td>
      <td>125.0</td>
      <td>625.0</td>
    </tr>
    <tr>
      <th>20,000 Leagues Under the Sea (1954)</th>
      <td>3.670103</td>
      <td>3.709205</td>
      <td>97.0</td>
      <td>478.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>X-Files: Fight the Future, The (1998)</th>
      <td>3.489474</td>
      <td>3.493797</td>
      <td>190.0</td>
      <td>806.0</td>
    </tr>
    <tr>
      <th>X-Men (2000)</th>
      <td>3.682310</td>
      <td>3.851702</td>
      <td>277.0</td>
      <td>1234.0</td>
    </tr>
    <tr>
      <th>You've Got Mail (1998)</th>
      <td>3.542424</td>
      <td>3.275591</td>
      <td>330.0</td>
      <td>508.0</td>
    </tr>
    <tr>
      <th>Young Frankenstein (1974)</th>
      <td>4.289963</td>
      <td>4.239177</td>
      <td>269.0</td>
      <td>924.0</td>
    </tr>
    <tr>
      <th>Young Guns (1988)</th>
      <td>3.371795</td>
      <td>3.425620</td>
      <td>78.0</td>
      <td>484.0</td>
    </tr>
  </tbody>
</table>
<p>618 rows × 4 columns</p>
</div>




```python
ex3[ex3['count'].sum(axis=1) >= 500]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">mean</th>
      <th colspan="2" halign="left">count</th>
    </tr>
    <tr>
      <th>성별</th>
      <th>F</th>
      <th>M</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10 Things I Hate About You (1999)</th>
      <td>3.646552</td>
      <td>3.311966</td>
      <td>232.0</td>
      <td>468.0</td>
    </tr>
    <tr>
      <th>101 Dalmatians (1961)</th>
      <td>3.791444</td>
      <td>3.500000</td>
      <td>187.0</td>
      <td>378.0</td>
    </tr>
    <tr>
      <th>12 Angry Men (1957)</th>
      <td>4.184397</td>
      <td>4.328421</td>
      <td>141.0</td>
      <td>475.0</td>
    </tr>
    <tr>
      <th>13th Warrior, The (1999)</th>
      <td>3.112000</td>
      <td>3.168000</td>
      <td>125.0</td>
      <td>625.0</td>
    </tr>
    <tr>
      <th>20,000 Leagues Under the Sea (1954)</th>
      <td>3.670103</td>
      <td>3.709205</td>
      <td>97.0</td>
      <td>478.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>X-Files: Fight the Future, The (1998)</th>
      <td>3.489474</td>
      <td>3.493797</td>
      <td>190.0</td>
      <td>806.0</td>
    </tr>
    <tr>
      <th>X-Men (2000)</th>
      <td>3.682310</td>
      <td>3.851702</td>
      <td>277.0</td>
      <td>1234.0</td>
    </tr>
    <tr>
      <th>You've Got Mail (1998)</th>
      <td>3.542424</td>
      <td>3.275591</td>
      <td>330.0</td>
      <td>508.0</td>
    </tr>
    <tr>
      <th>Young Frankenstein (1974)</th>
      <td>4.289963</td>
      <td>4.239177</td>
      <td>269.0</td>
      <td>924.0</td>
    </tr>
    <tr>
      <th>Young Guns (1988)</th>
      <td>3.371795</td>
      <td>3.425620</td>
      <td>78.0</td>
      <td>484.0</td>
    </tr>
  </tbody>
</table>
<p>618 rows × 4 columns</p>
</div>




```python
abs(ex3[('mean','F')] - ex3[('mean','M')]).nlargest(10)
```




    영화제목
    Dirty Dancing (1987)                      0.830782
    Good, The Bad and The Ugly, The (1966)    0.726351
    Dumb & Dumber (1994)                      0.638608
    Evil Dead II (Dead By Dawn) (1987)        0.611985
    Grease (1978)                             0.608224
    Caddyshack (1980)                         0.573602
    Animal House (1978)                       0.538286
    Exorcist, The (1973)                      0.529605
    Rocky Horror Picture Show, The (1975)     0.512885
    Big Trouble in Little China (1986)        0.497078
    dtype: float64




```python

```

## [실습 #4] 연령대 별로 영화 평점 분석하기
연령대(10대 미만, 10대, 20대, ...50대) 컬럼을 추가한 후, 영화별 연령대별 영화평점 구하기


```python
def generate_ages(x):
    if x<10:
        return '10대 미만'
    elif x<20:
        return '10대'
    elif x<30:
        return '20대'
    elif x<40:
        return '30대'
    elif x<50:
        return '40대'
    elif x<60:
        return '50대 이상'
```


```python
generate_ages(56)
```




    '50대 이상'




```python
data['연령대'] = data.연령.apply(generate_ages)
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>사용자아이디</th>
      <th>성별</th>
      <th>연령</th>
      <th>직업</th>
      <th>지역</th>
      <th>영화아이디</th>
      <th>평점</th>
      <th>타임스탬프</th>
      <th>영화제목</th>
      <th>장르</th>
      <th>연령대</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
      <td>10대 미만</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
      <td>1193</td>
      <td>5</td>
      <td>978298413</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
      <td>50대 이상</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>M</td>
      <td>25</td>
      <td>12</td>
      <td>32793</td>
      <td>1193</td>
      <td>4</td>
      <td>978220179</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
      <td>20대</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>M</td>
      <td>25</td>
      <td>7</td>
      <td>22903</td>
      <td>1193</td>
      <td>4</td>
      <td>978199279</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
      <td>20대</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
      <td>M</td>
      <td>50</td>
      <td>1</td>
      <td>95350</td>
      <td>1193</td>
      <td>5</td>
      <td>978158471</td>
      <td>One Flew Over the Cuckoo's Nest (1975)</td>
      <td>Drama</td>
      <td>50대 이상</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1000204</th>
      <td>5949</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>47901</td>
      <td>2198</td>
      <td>5</td>
      <td>958846401</td>
      <td>Modulations (1998)</td>
      <td>Documentary</td>
      <td>10대</td>
    </tr>
    <tr>
      <th>1000205</th>
      <td>5675</td>
      <td>M</td>
      <td>35</td>
      <td>14</td>
      <td>30030</td>
      <td>2703</td>
      <td>3</td>
      <td>976029116</td>
      <td>Broken Vessels (1998)</td>
      <td>Drama</td>
      <td>30대</td>
    </tr>
    <tr>
      <th>1000206</th>
      <td>5780</td>
      <td>M</td>
      <td>18</td>
      <td>17</td>
      <td>92886</td>
      <td>2845</td>
      <td>1</td>
      <td>958153068</td>
      <td>White Boys (1999)</td>
      <td>Drama</td>
      <td>10대</td>
    </tr>
    <tr>
      <th>1000207</th>
      <td>5851</td>
      <td>F</td>
      <td>18</td>
      <td>20</td>
      <td>55410</td>
      <td>3607</td>
      <td>5</td>
      <td>957756608</td>
      <td>One Little Indian (1973)</td>
      <td>Comedy|Drama|Western</td>
      <td>10대</td>
    </tr>
    <tr>
      <th>1000208</th>
      <td>5938</td>
      <td>M</td>
      <td>25</td>
      <td>1</td>
      <td>35401</td>
      <td>2909</td>
      <td>4</td>
      <td>957273353</td>
      <td>Five Wives, Three Secretaries and Me (1998)</td>
      <td>Documentary</td>
      <td>20대</td>
    </tr>
  </tbody>
</table>
<p>1000209 rows × 11 columns</p>
</div>




```python
연령평점 = data.pivot_table(index='영화제목', columns='연령대', 
                        aggfunc=['mean'], values='평점')
```


```python
연령평점
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">mean</th>
    </tr>
    <tr>
      <th>연령대</th>
      <th>10대</th>
      <th>10대 미만</th>
      <th>20대</th>
      <th>30대</th>
      <th>40대</th>
      <th>50대 이상</th>
    </tr>
    <tr>
      <th>영화제목</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>$1,000,000 Duck (1971)</th>
      <td>3.000000</td>
      <td>NaN</td>
      <td>3.090909</td>
      <td>3.133333</td>
      <td>2.000000</td>
      <td>2.750000</td>
    </tr>
    <tr>
      <th>'Night Mother (1986)</th>
      <td>4.666667</td>
      <td>2.000000</td>
      <td>3.423077</td>
      <td>2.904762</td>
      <td>3.833333</td>
      <td>3.750000</td>
    </tr>
    <tr>
      <th>'Til There Was You (1997)</th>
      <td>2.500000</td>
      <td>3.500000</td>
      <td>2.666667</td>
      <td>2.900000</td>
      <td>2.333333</td>
      <td>2.600000</td>
    </tr>
    <tr>
      <th>'burbs, The (1989)</th>
      <td>3.244444</td>
      <td>4.500000</td>
      <td>2.652174</td>
      <td>2.818182</td>
      <td>2.545455</td>
      <td>3.100000</td>
    </tr>
    <tr>
      <th>...And Justice for All (1979)</th>
      <td>3.428571</td>
      <td>3.000000</td>
      <td>3.724138</td>
      <td>3.657143</td>
      <td>4.100000</td>
      <td>3.674419</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zed &amp; Two Noughts, A (1985)</th>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>3.375000</td>
      <td>3.777778</td>
      <td>4.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>Zero Effect (1998)</th>
      <td>3.883333</td>
      <td>4.125000</td>
      <td>3.715278</td>
      <td>3.608696</td>
      <td>3.764706</td>
      <td>3.769231</td>
    </tr>
    <tr>
      <th>Zero Kelvin (Kjærlighetens kjøtere) (1995)</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.500000</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Zeus and Roxanne (1997)</th>
      <td>2.500000</td>
      <td>1.500000</td>
      <td>2.833333</td>
      <td>3.500000</td>
      <td>1.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>eXistenZ (1999)</th>
      <td>3.289157</td>
      <td>3.142857</td>
      <td>3.234973</td>
      <td>3.364865</td>
      <td>3.222222</td>
      <td>3.103448</td>
    </tr>
  </tbody>
</table>
<p>3706 rows × 6 columns</p>
</div>




```python

```
